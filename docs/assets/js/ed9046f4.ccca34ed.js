"use strict";(globalThis.webpackChunkhumanoid_robotics_book=globalThis.webpackChunkhumanoid_robotics_book||[]).push([[927],{8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>l});var s=r(6540);const i={},o=s.createContext(i);function t(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),s.createElement(o.Provider,{value:n},e.children)}},9030:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>m,frontMatter:()=>t,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"module-1/ros2-nodes-topics-services","title":"ROS 2 Nodes, Topics, and Services","description":"Chapter Objectives","source":"@site/docs/module-1/ros2-nodes-topics-services.md","sourceDirName":"module-1","slug":"/module-1/ros2-nodes-topics-services","permalink":"/Physical-AI-humanoid-robotic-chatbot-book/docs/module-1/ros2-nodes-topics-services","draft":false,"unlisted":false,"editUrl":"https://github.com/Mrsaleem110/Physical-AI-humanoid-robotic-chatbot-book/tree/main/docs/docs/module-1/ros2-nodes-topics-services.md","tags":[],"version":"current","lastUpdatedBy":"muhammad_saleem","lastUpdatedAt":1765979454000,"sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Introduction to ROS 2","permalink":"/Physical-AI-humanoid-robotic-chatbot-book/docs/module-1/intro-to-ros2"},"next":{"title":"Python \u2192 ROS Control via rclpy","permalink":"/Physical-AI-humanoid-robotic-chatbot-book/docs/module-1/python-ros-control"}}');var i=r(4848),o=r(8453);const t={sidebar_position:2},l="ROS 2 Nodes, Topics, and Services",c={},a=[{value:"Chapter Objectives",id:"chapter-objectives",level:2},{value:"ROS 2 Communication Patterns",id:"ros-2-communication-patterns",level:2},{value:"Nodes: The Basic Computational Units",id:"nodes-the-basic-computational-units",level:2},{value:"Creating a Node",id:"creating-a-node",level:3},{value:"Running a Node",id:"running-a-node",level:3},{value:"Topics: Publish/Subscribe Communication",id:"topics-publishsubscribe-communication",level:2},{value:"Publisher Example",id:"publisher-example",level:3},{value:"Subscriber Example",id:"subscriber-example",level:3},{value:"Services: Request/Response Communication",id:"services-requestresponse-communication",level:2},{value:"Service Definition",id:"service-definition",level:3},{value:"Service Server",id:"service-server",level:3},{value:"Service Client",id:"service-client",level:3},{value:"ROS 2 Commands for Communication",id:"ros-2-commands-for-communication",level:2},{value:"Topic Commands",id:"topic-commands",level:3},{value:"Service Commands",id:"service-commands",level:3},{value:"Best Practices for Humanoid Robots",id:"best-practices-for-humanoid-robots",level:2},{value:"Topic Design",id:"topic-design",level:3},{value:"Service Design",id:"service-design",level:3},{value:"Hands-On Exercise",id:"hands-on-exercise",level:2},{value:"Summary",id:"summary",level:2},{value:"Learning Path Adjustment",id:"learning-path-adjustment",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"ros-2-nodes-topics-and-services",children:"ROS 2 Nodes, Topics, and Services"})}),"\n",(0,i.jsx)(n.h2,{id:"chapter-objectives",children:"Chapter Objectives"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Understand the fundamental ROS 2 communication patterns"}),"\n",(0,i.jsx)(n.li,{children:"Create and run ROS 2 nodes"}),"\n",(0,i.jsx)(n.li,{children:"Implement publisher-subscriber communication (topics)"}),"\n",(0,i.jsx)(n.li,{children:"Implement client-server communication (services)"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"ros-2-communication-patterns",children:"ROS 2 Communication Patterns"}),"\n",(0,i.jsx)(n.p,{children:"ROS 2 provides three main communication patterns:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Topics (Publish/Subscribe)"}),": Asynchronous, many-to-many communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Services (Request/Response)"}),": Synchronous, one-to-one communication"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Actions (Goal/Result/Feedback)"}),": Asynchronous, goal-oriented communication"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"nodes-the-basic-computational-units",children:"Nodes: The Basic Computational Units"}),"\n",(0,i.jsx)(n.p,{children:"A node is a process that performs computation. In ROS 2:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Each node runs in its own process"}),"\n",(0,i.jsx)(n.li,{children:"Nodes communicate with each other through topics, services, and actions"}),"\n",(0,i.jsx)(n.li,{children:"Nodes are organized into packages"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"creating-a-node",children:"Creating a Node"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# my_robot_package/my_robot_package/simple_node.py\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass SimpleNode(Node):\r\n    def __init__(self):\r\n        super().__init__('simple_node')\r\n        self.get_logger().info('Simple Node Created')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    node = SimpleNode()\r\n\r\n    try:\r\n        rclpy.spin(node)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        node.destroy_node()\r\n        rclpy.shutdown()\r\n\r\nif __name__ == '__main__':\r\n    main()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"running-a-node",children:"Running a Node"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Make sure your workspace is sourced\r\nsource install/setup.bash\r\n\r\n# Run the node\r\nros2 run my_robot_package simple_node\n"})}),"\n",(0,i.jsx)(n.h2,{id:"topics-publishsubscribe-communication",children:"Topics: Publish/Subscribe Communication"}),"\n",(0,i.jsx)(n.p,{children:"Topics enable asynchronous communication between nodes using a publish/subscribe model:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Publishers send messages to topics"}),"\n",(0,i.jsx)(n.li,{children:"Subscribers receive messages from topics"}),"\n",(0,i.jsx)(n.li,{children:"Multiple publishers and subscribers can use the same topic"}),"\n",(0,i.jsx)(n.li,{children:"Communication is asynchronous and non-blocking"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"publisher-example",children:"Publisher Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# my_robot_package/my_robot_package/talker.py\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass Talker(Node):\r\n    def __init__(self):\r\n        super().__init__('talker')\r\n        self.publisher = self.create_publisher(String, 'chatter', 10)\r\n        timer_period = 0.5  # seconds\r\n        self.timer = self.create_timer(timer_period, self.timer_callback)\r\n        self.i = 0\r\n\r\n    def timer_callback(self):\r\n        msg = String()\r\n        msg.data = f'Hello World: {self.i}'\r\n        self.publisher.publish(msg)\r\n        self.get_logger().info(f'Publishing: \"{msg.data}\"')\r\n        self.i += 1\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    talker = Talker()\r\n\r\n    try:\r\n        rclpy.spin(talker)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        talker.destroy_node()\r\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"subscriber-example",children:"Subscriber Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# my_robot_package/my_robot_package/listener.py\r\nimport rclpy\r\nfrom rclpy.node import Node\r\nfrom std_msgs.msg import String\r\n\r\nclass Listener(Node):\r\n    def __init__(self):\r\n        super().__init__('listener')\r\n        self.subscription = self.create_subscription(\r\n            String,\r\n            'chatter',\r\n            self.listener_callback,\r\n            10)\r\n        self.subscription  # prevent unused variable warning\r\n\r\n    def listener_callback(self, msg):\r\n        self.get_logger().info(f'I heard: \"{msg.data}\"')\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    listener = Listener()\r\n\r\n    try:\r\n        rclpy.spin(listener)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        listener.destroy_node()\r\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"services-requestresponse-communication",children:"Services: Request/Response Communication"}),"\n",(0,i.jsx)(n.p,{children:"Services provide synchronous request/response communication:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Client sends a request to a service"}),"\n",(0,i.jsx)(n.li,{children:"Server processes the request and sends a response"}),"\n",(0,i.jsx)(n.li,{children:"Communication is synchronous and blocking"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"service-definition",children:"Service Definition"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Create service definition file: srv/AddTwoInts.srv\r\nint64 a\r\nint64 b\r\n---\r\nint64 sum\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-server",children:"Service Server"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# my_robot_package/my_robot_package/add_two_ints_server.py\r\nfrom my_robot_package.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass AddTwoIntsServer(Node):\r\n    def __init__(self):\r\n        super().__init__('add_two_ints_server')\r\n        self.srv = self.create_service(AddTwoInts, 'add_two_ints', self.add_two_ints_callback)\r\n\r\n    def add_two_ints_callback(self, request, response):\r\n        response.sum = request.a + request.b\r\n        self.get_logger().info(f'Returning: [{response.sum}]')\r\n        return response\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    add_two_ints_server = AddTwoIntsServer()\r\n\r\n    try:\r\n        rclpy.spin(add_two_ints_server)\r\n    except KeyboardInterrupt:\r\n        pass\r\n    finally:\r\n        add_two_ints_server.destroy_node()\r\n        rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-client",children:"Service Client"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# my_robot_package/my_robot_package/add_two_ints_client.py\r\nfrom my_robot_package.srv import AddTwoInts\r\nimport rclpy\r\nfrom rclpy.node import Node\r\n\r\nclass AddTwoIntsClient(Node):\r\n    def __init__(self):\r\n        super().__init__('add_two_ints_client')\r\n        self.cli = self.create_client(AddTwoInts, 'add_two_ints')\r\n        while not self.cli.wait_for_service(timeout_sec=1.0):\r\n            self.get_logger().info('Service not available, waiting again...')\r\n        self.req = AddTwoInts.Request()\r\n\r\n    def send_request(self, a, b):\r\n        self.req.a = a\r\n        self.req.b = b\r\n        self.future = self.cli.call_async(self.req)\r\n        rclpy.spin_until_future_complete(self, self.future)\r\n        return self.future.result()\r\n\r\ndef main(args=None):\r\n    rclpy.init(args=args)\r\n    add_two_ints_client = AddTwoIntsClient()\r\n    response = add_two_ints_client.send_request(1, 2)\r\n    add_two_ints_client.get_logger().info(f'Result of add_two_ints: {response.sum}')\r\n\r\n    add_two_ints_client.destroy_node()\r\n    rclpy.shutdown()\n"})}),"\n",(0,i.jsx)(n.h2,{id:"ros-2-commands-for-communication",children:"ROS 2 Commands for Communication"}),"\n",(0,i.jsx)(n.h3,{id:"topic-commands",children:"Topic Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# List all topics\r\nros2 topic list\r\n\r\n# Echo messages from a topic\r\nros2 topic echo /chatter std_msgs/msg/String\r\n\r\n# Publish a message to a topic\r\nros2 topic pub /chatter std_msgs/msg/String \"data: 'Hello World'\"\r\n\r\n# Get info about a topic\r\nros2 topic info /chatter\n"})}),"\n",(0,i.jsx)(n.h3,{id:"service-commands",children:"Service Commands"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'# List all services\r\nros2 service list\r\n\r\n# Call a service\r\nros2 service call /add_two_ints my_robot_package/srv/AddTwoInts "{a: 1, b: 2}"\r\n\r\n# Get info about a service\r\nros2 service info /add_two_ints\n'})}),"\n",(0,i.jsx)(n.h2,{id:"best-practices-for-humanoid-robots",children:"Best Practices for Humanoid Robots"}),"\n",(0,i.jsx)(n.h3,{id:"topic-design",children:"Topic Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use appropriate message rates for real-time control"}),"\n",(0,i.jsx)(n.li,{children:"Consider bandwidth limitations for wireless communication"}),"\n",(0,i.jsx)(n.li,{children:"Use latching for static data that new subscribers need"}),"\n",(0,i.jsx)(n.li,{children:"Implement QoS (Quality of Service) settings for reliability"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"service-design",children:"Service Design"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use services for operations that should complete successfully"}),"\n",(0,i.jsx)(n.li,{children:"Implement timeouts to prevent hanging"}),"\n",(0,i.jsx)(n.li,{children:"Use actions instead of services for long-running operations"}),"\n",(0,i.jsx)(n.li,{children:"Design services to be idempotent when possible"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"hands-on-exercise",children:"Hands-On Exercise"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Create a publisher that publishes joint positions for a humanoid robot"}),"\n",(0,i.jsx)(n.li,{children:"Create a subscriber that logs these positions"}),"\n",(0,i.jsx)(n.li,{children:"Create a service that calculates inverse kinematics for a target position"}),"\n",(0,i.jsx)(n.li,{children:"Test communication using ROS 2 command-line tools"}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"summary",children:"Summary"}),"\n",(0,i.jsx)(n.p,{children:"Understanding ROS 2 communication patterns is essential for building humanoid robots. Topics provide asynchronous data flow, while services provide synchronous request/response communication. In the next chapter, we'll explore Python integration with ROS 2."}),"\n",(0,i.jsx)(n.h2,{id:"learning-path-adjustment",children:"Learning Path Adjustment"}),"\n",(0,i.jsx)(n.p,{children:"Based on your experience level, you may want to focus on:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Beginner"}),": Focus on understanding the publish/subscribe model and basic node creation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Intermediate"}),": Dive deeper into QoS settings and message types"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Advanced"}),": Explore custom message definitions and real-time considerations"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}}}]);